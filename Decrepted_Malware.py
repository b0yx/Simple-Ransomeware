import os
from cryptography.fernet import Fernet as fer

# Load the encryption key from the file
with open("key", "rb") as key_file:
    SecretKey = key_file.read()

# Create a Fernet object with the loaded key
cipher = fer(SecretKey)

# List to hold paths of all files
files = []

# Walk through all directories and files in the system
for dirpath, dirnames, filenames in os.walk('C:\\'):  # Change 'C:\\' for the root drive
    for file in filenames:
        full_path = os.path.join(dirpath, file)  # Get the full path of the file
        files.append(full_path)

# Decrypt all collected files
for file in files:
    try:
        with open(file, "rb") as thefile:
            contents = thefile.read()
        contents_dec = cipher.decrypt(contents)
        with open(file, "wb") as Thefiles:
            Thefiles.write(contents_dec)
    except Exception as e:
        print(f"Error decrypting {file}: {e}")

print("Decryption process completed.")
